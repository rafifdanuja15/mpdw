---
title: "Tugas Pertemuan 4"
author: "Muhammad Rafif Danuja"
date: "`r Sys.Date()`"
output:
  html_document:
    theme: flatly     
    highlight: tango  
    toc: true         
    toc_depth: 3
    toc_float: true   
    number_sections: true
    df_print: paged   
---

# MA(2)

## Pembangkitan Data

```{r}
set.seed(1015)
wn <- rnorm(300)
n <- 300  
ts.plot(wn)
```

```{r}
par(mfrow = c(1, 2)) 
acf(wn)
acf(wn, xlim = c(1, 20))
```

```{r}
set.seed(1015)
ma <- wn[1:2]
```

```{r}
for(i in 3:n){      
  ma[i] <- wn[i] + 0.4 * wn[i - 1] + 0.6 * wn[i - 2]
}

ma
```

```{r}
set.seed(1015)
ma2 <- arima.sim(
  list(order = c(0,0,2), ma = c(0.4, 0.6)), 
  n = 300
)
ma2
```

## Plot Time Series

```{r}
ts.plot(ma2)
```

Berdasarkan plot time series, terlihat bahwa data MA(2) yang dibangkitkan bersifat stasioner dalam rataan, ditunjukkan oleh nilai rata-rata yang relatif konstan dari waktu ke waktu tanpa adanya tren naik atau turun yang jelas.

## Plot ACF

```{r}
acf(ma2,lag.max = 20)
```

Berdasarkan plot ACF tersebut, terlihat bahwa nilai autokorelasi mengalami cut-off setelah lag ke-2, yaitu hanya signifikan pada lag 1 dan lag 2, sedangkan untuk lag-lag berikutnya nilainya mendekati nol dan tidak lagi signifikan.

## Plot PACF

```{r}
pacf(ma2)
```

Berdasarkan plot PACF tersebut, terlihat bahwa nilai PACF tidak terputus secara jelas, melainkan menunjukkan pola tails off yang secara perlahan mengecil seiring bertambahnya lag. Selain itu, bentuk plot PACF memperlihatkan pola menyerupai gelombang sinus yang berosilasi di sekitar nol. Pola ini merupakan karakteristik dari proses Moving Average orde 2.

## Plot EACF

```{r}
TSA::eacf(ma2)
```

Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(0) dan ordo MA(2)

## Scatterplot Antar Lag

### Korelasi antara Yt dengan Yt−1

```{r}
yt_ma <- ma2[-1]
yt_ma
```

```{r}
yt_1_ma <- ma2[-300]
yt_1_ma
```

```{r}
plot(y=yt_ma,x=yt_1_ma)
```

```{r}
cor(yt_ma,yt_1_ma)
```

Teoritis :

$$
\rho_1 = \frac{\gamma_1}{\gamma_0} = \frac{\theta_1 + \theta_1 \theta_2}{1 + \theta_1^2 + \theta_2^2} = \frac{0.4+(0.4)(0.6)}{1+0.4^2+0.6^2}=0.421
$$

### Korelasi antara Yt dengan Yt−2

```{r}
yt_ma2 <- ma2[-c(1,2)]
yt_ma2
```

```{r}
yt_2_ma <- ma2[-c(299,300)]
yt_2_ma
```

```{r}
plot(y=yt_ma2,x=yt_2_ma)
```

```{r}
cor(yt_ma2,yt_2_ma)
```

Teoritis :

$$ \rho_2 = \frac{\gamma_2}{\gamma_0} = \frac{\theta_2}{1 + \theta_1^2 + \theta_2^2} = \frac{0.6}{1+0.4^2+0.6^2}=0.395 $$

### Korelasi antara Yt dengan Yt-3

```{r}
yt <- ma2[-c(1,2,3)] 
yt
```

```{r}
yt_3ma <- ma2[-c(298,299,300)] 
yt_3ma
```

```{r}
plot(y=yt,x=yt_3ma)
```

```{r}
cor(yt, yt_3ma) 
```

Teoritis :

$$
\rho_3 = 0
$$

# AR(2)

## Pembangkitan Data

```{r}
set.seed(1015)
```

```{r}
n<-length(wn)
n
```

```{r}
ar2 <- numeric(n)    

for (i in 3:n) {    
  ar2[i] <- wn[i] + 0.5 * ar2[i-1] + 0.2 * ar2[i-2]
}

ar2
```

```{r}
ar <- arima.sim(
  list(order = c(2,0,0), ar = c(0.5, 0.2)), 
  n = 300
)
ar
```

## Plot Time Series

```{r}
ts.plot(ar)
```

Berdasarkan plot time series di atas, terlihat bahwa data hasil bangkitan dari proses AR(2) berfluktuasi di sekitar rata-rata nol tanpa menunjukkan adanya tren naik maupun tren turun yang jelas dari waktu ke waktu. Hal ini menunjukkan bahwa data tersebut stasioner.

## Plot ACF

```{r}
acf(ar)
```

Terlihat bahwa nilai autokorelasi menurun secara bertahap (tails off) dan tidak mengalami cut-off pada lag tertentu. Pola ini sesuai dengan karakteristik proses AR, di mana ACF mengecil perlahan seiring bertambahnya lag.

## Plot PACF

```{r}
pacf(ar)
```

Nilai partial autocorrelation menunjukkan cut-off yang jelas pada lag ke-2, sementara lag setelahnya tidak signifikan. Pola ini merupakan ciri khas dari proses AR(2), di mana PACF terputus pada lag sesuai dengan orde model.

## Plot EACF

```{r}
TSA::eacf(ar)
```

Tabel pemilihan orde ARMA menunjukkan bahwa kombinasi AR(2) dengan berbagai orde MA (q ≥ 1) umumnya menghasilkan model yang layak (ditandai dengan simbol o). Hal ini sejalan dengan analisis sebelumnya bahwa proses data dapat direpresentasikan dengan komponen autoregresif orde 2. Pola ini memperkuat indikasi bahwa AR(2) merupakan struktur utama yang relevan dalam model

## Scatterplot Antar Lag

### Korelasi antara Yt dengan Yt−1

```{r}
yt_ar <- ar[-1]
yt_ar
```

```{r}
yt_1_ar <- ar[-300]
yt_1_ar
```

```{r}
plot(y=yt_ar,x=yt_1_ar)
```

```{r}
cor(yt_ar,yt_1_ar)
```

Teoritis

$$
\rho_1 = \frac{\phi_1}{1 - \phi_2}=\frac{0.5}{1-0.2}=0.625
$$

### Korelasi antara Yt dengan Yt-2

```{r}
yt_ar2 <- ar[-c(1,2)]
yt_ar2
```

```{r}
yt_2_ar <- ar[-c(299,300)]
yt_2_ar
```

```{r}
plot(y=yt_ar2,x=yt_2_ar)
```

```{r}
cor(yt_ar2,yt_2_ar)
```

Teoritis :

$$
\rho_2 = \frac{\phi_1 \rho_1 + \phi_2}{1}
         = \frac{\phi_1^2}{1 - \phi_2} + \phi_2=\frac{0.5^2}{1-0.2}+0.2=0.5125
$$

### Korelasi antara Yt dengan Yt-3

```{r}
yt     <- ar[-c(1,2,3)] 
yt
```

```{r}
yt_3ar <- ar[-c(298,299,300)] 
yt_3ar
```

```{r}
plot(y=yt,x=yt_3ar)
```

```{r}
cor(yt,yt_3ar)
```

Teoritis :

$$
\rho_3 = \phi_1 \rho_2 + \phi_2 \rho_1=0.5(0.5125)+0.2(0.625)=0.38125
$$

# ARMA(2,2)

## Pembangkitan Data

```{r}
set.seed(1015)
n <- 300
wn <- rnorm(n)       
arma <- numeric(n)   

for (i in 3:n) {
  arma[i] <- 0.5 * arma[i-1] + 0.2 * arma[i-2] + 
             wn[i] + 0.4 * wn[i-1] + 0.6 * wn[i-2]
}

arma
```

```{r}
set.seed(1015)
arma_sim <- arima.sim(
  list(order = c(2,0,2), ar = c(0.5, 0.2), ma = c(0.4, 0.6)),
  n = 300
)

arma_sim
```

## Plot Time Series

```{r}
par(mfrow = c(1, 2))
ts.plot(arma)
ts.plot(arma_sim)
```

Kedua plot menampilkan pola fluktuasi acak yang serupa, berosilasi di sekitar rata-rata nol tanpa adanya tren jangka panjang. Hal ini menunjukkan bahwa proses yang terbentuk bersifat stasioner, baik dalam mean maupun varians, sehingga model ARMA yang dibangun mampu merepresentasikan data dengan baik dan menghasilkan simulasi yang konsisten dengan sifat proses aslinya.

## Plot ACF

```{r}
par(mfrow = c(1, 2))
acf(arma)
acf(arma_sim)
```

## Plot PACF

```{r}
par(mfrow = c(1, 2))
pacf(arma)
pacf(arma_sim)
```

## Plot EACF

```{r}
TSA::eacf(arma)
```

```{r}
TSA::eacf(arma_sim)
```

## Scatterplot Antar Lag

### Korelasi antara Yt dengan Yt−1

```{r}
yt_arma <- arma_sim[-1]
yt_arma
```

```{r}
yt_1_arma <- arma_sim[-300]
yt_1_arma
```

```{r}
plot(y=yt_arma,x=yt_1_arma)
```

```{r}
cor(yt_arma,yt_1_arma)
```

Teoritis :

$$
\gamma_0 = (1 + \theta_1^2 + \theta_2^2)\sigma^2 + \phi_1 \theta_1 \sigma^2 + \phi_2 \theta_2 \sigma^2 + \phi_1 \theta_1 \theta_2 \sigma^2
$$
$$
= (1 + 0.4^2 + 0.6^2)\sigma^2 + 0.5(0.4)\sigma^2 + 0.2(0.6)\sigma^2 + 0.5(0.4)(0.6)\sigma^2
$$
$$
= 1.96\sigma^2
$$

$$
\gamma_1 = (\theta_1 + \theta_1\theta_2 + \phi_1 + \phi_1\theta_1)\sigma^2 + \phi_2\gamma_0
$$
$$
= (0.4 + 0.4(0.6) + 0.5 + 0.5(0.4))\sigma^2 + 0.2(1.96\sigma^2)
$$
$$
= 1.732\sigma^2
$$

$$
\gamma_2 = \theta_2\sigma^2 + \phi_1\gamma_1 + \phi_2\gamma_0
$$
$$
= 0.6\sigma^2 + 0.5(1.732\sigma^2) + 0.2(1.96\sigma^2)
$$
$$
= 1.858\sigma^2
$$

$$
\gamma_3 = \phi_1\gamma_2 + \phi_2\gamma_1
$$
$$
= 0.5(1.858\sigma^2) + 0.2(1.732\sigma^2)
$$
$$
= 1.2754\sigma^2
$$

Autokorelasi

$$
\rho_1 = \frac{\gamma_1}{\gamma_0} = \frac{1.732\sigma^2}{1.96\sigma^2} \approx 0.8837
$$

### Korelasi antara Yt dengan Yt-2

```{r}
yt_arma2 <- arma_sim[-c(1,2)]
yt_arma2
```

```{r}
yt_2_arma <- arma_sim[-c(299,300)]
yt_2_arma
```

```{r}
plot(y=yt_arma2,x=yt_2_arma)
```

```{r}
cor(yt_arma2,yt_2_arma)
```
Teoritis :
$$
\rho_2 = \frac{\gamma_2}{\gamma_0} 
= \frac{1.858\sigma^2}{1.96\sigma^2} 
\approx 0.9480
$$

### Korelasi antara Yt dengan Yt-3

```{r}
yt_arma     <- arma_sim[-c(1,2,3)] 
yt_arma
```

```{r}
yt_3arma <- arma_sim[-c(298,299,300)] 
yt_3arma
```

```{r}
plot(y=yt_arma,x=yt_3arma)
```

```{r}
cor(yt_arma,yt_3arma)
```
Teoritis :
$$
\rho_3 = \frac{\gamma_3}{\gamma_0} 
= \frac{1.2754\sigma^2}{1.96\sigma^2} 
\approx 0.6507
$$
