---
title: "Tugas-Pertemuan-4"
author: "Rafif"
date: "2025-09-21"
output: html_document
---

# MA(2)

## Pembangkitan Data

```{r}
set.seed(1015)
wn <- rnorm(300)
ts.plot(wn)
```

```{r}
par(mfrow = c(1, 2)) 
acf(wn)
acf(wn, xlim = c(1, 20))
```

```{r}
set.seed(1015)
ma <- wn[1:2]
```

```{r}
for(i in 3:n){      
  ma[i] <- wn[i] + 0.4 * wn[i - 1] + 0.6 * wn[i - 2]
}

ma
```
## Pembangkitan data dengan arima.sim

```{r}
set.seed(1015)
ma2 <- arima.sim(
  list(order = c(0,0,2), ma = c(0.4, 0.6)), 
  n = 300
)
ma2
```

## Plot Time Series

```{r}
ts.plot(ma2)
```
## Plot ACF

```{r}
acf(ma2,lag.max = 20)
```

## Plot PACF

```{r}
pacf(ma2)
```

## Plot EACF

```{r}
TSA::eacf(ma2)
```
## Scatterplot Antar Lag
### Korelasi antara Yt dengan Yt−1

```{r}
yt_ma <- ma2[-1]
yt_ma
```

```{r}
yt_1_ma <- ma2[-300]
yt_1_ma
```

```{r}
plot(y=yt_ma,x=yt_1_ma)
```

```{r}
cor(yt_ma,yt_1_ma)
```
### Korelasi antara Yt dengan Yt−2

```{r}
yt_ma2 <- ma2[-c(1,2)]
yt_ma2
```
```{r}
yt_2_ma <- ma2[-c(299,300)]
yt_2_ma
```

```{r}
plot(y=yt_ma2,x=yt_2_ma)
```
```{r}
cor(yt_ma2,yt_2_ma)
```
### Korelasi antara Yt dengan Yt-3

```{r}
yt     <- ma2[-c(1,2,3)] 
yt
```
```{r}
yt_3ma <- ma2[-c(298,299,300)] 
yt_3ma
```
```{r}
plot(y=yt,x=yt_3ma)
```



```{r}
cor(yt, yt_3ma) 
```

# AR(2)

## Pembangkitan Data

```{r}
set.seed(1015)
```

```{r}
n<-length(wn)
n
```

```{r}
ar2 <- numeric(n)    

for (i in 3:n) {    
  ar2[i] <- wn[i] + 0.5 * ar2[i-1] + 0.2 * ar2[i-2]
}

ar2
```

```{r}
ar <- arima.sim(
  list(order = c(2,0,0), ar = c(0.5, 0.2)), 
  n = 300
)
ar
```
## Plot Time Series

```{r}
ts.plot(ar)
```
## Plot ACF

```{r}
acf(ar)
```

## Plot PACF

```{r}
pacf(ar)
```

## Plot EACF

```{r}
TSA::eacf(ar)
```
## Scatterplot Antar Lag

### Korelasi antara Yt dengan Yt−1

```{r}
yt_ar <- ar[-1]
yt_ar
```
```{r}
yt_1_ar <- ar[-300]
yt_1_ar
```
```{r}
plot(y=yt_ar,x=yt_1_ar)
```
```{r}
cor(yt_ar,yt_1_ar)
```

### Korelasi antara Yt dengan Yt-2

```{r}
yt_ar2 <- ar[-c(1,2)]
yt_ar2
```
```{r}
yt_2_ar <- ar[-c(299,300)]
yt_2_ar
```

```{r}
plot(y=yt_ar2,x=yt_2_ar)
```

```{r}
cor(yt_ar2,yt_2_ar)
```
### Korelasi antara Yt dengan Yt-3

```{r}
yt     <- ar[-c(1,2,3)] 
yt
```
```{r}
yt_3ar <- ar[-c(298,299,300)] 
yt_3ar
```

```{r}
plot(y=yt,x=yt_3ar)
```

```{r}
cor(yt,yt_3ar)
```


# ARMA(2,2)

## Pembangkitan Data

```{r}
set.seed(1015)
n <- 300
wn <- rnorm(n)       
arma <- numeric(n)   

for (i in 3:n) {
  arma[i] <- 0.5 * arma[i-1] + 0.2 * arma[i-2] + 
             wn[i] + 0.4 * wn[i-1] + 0.6 * wn[i-2]
}

arma
```
```{r}
set.seed(1015)
arma_sim <- arima.sim(
  list(order = c(2,0,2), ar = c(0.5, 0.2), ma = c(0.4, 0.6)),
  n = 300
)

arma_sim
```

## Plot Time Series

```{r}
par(mfrow = c(1, 2))
ts.plot(arma)
ts.plot(arma_sim)
```
## Plot ACF

```{r}
par(mfrow = c(1, 2))
acf(arma)
acf(arma_sim)
```

## Plot PACF

```{r}
par(mfrow = c(1, 2))
pacf(arma)
pacf(arma_sim)
```

## Plot EACF

```{r}
TSA::eacf(arma)
```
```{r}
TSA::eacf(arma_sim)
```
## Scatterplot Antar Lag

### Korelasi antara Yt dengan Yt−1

```{r}
yt_arma <- arma_sim[-1]
yt_arma
```

```{r}
yt_1_arma <- arma_sim[-300]
yt_1_arma
```

```{r}
plot(y=yt_arma,x=yt_1_arma)
```

```{r}
cor(yt_arma,yt_1_arma)
```

### Korelasi antara Yt dengan Yt-2

```{r}
yt_arma2 <- arma_sim[-c(1,2)]
yt_arma2
```
```{r}
yt_2_arma <- arma_sim[-c(299,300)]
yt_2_arma
```

```{r}
plot(y=yt_arma2,x=yt_2_arma)
```

```{r}
cor(yt_arma2,yt_2_arma)
```

### Korelasi antara Yt dengan Yt-3

```{r}
yt_arma     <- arma_sim[-c(1,2,3)] 
yt_arma
```
```{r}
yt_3arma <- arma_sim[-c(298,299,300)] 
yt_3arma
```

```{r}
plot(y=yt_arma,x=yt_3arma)
```

```{r}
cor(yt_arma,yt_3arma)
```

